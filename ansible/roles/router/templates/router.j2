## Config generated by Ansible and Jinja2

hostname {{item.hostname}}

archive
 log config
  logging enable
  logging persistent auto
  logging size 1000
  hidekeys

interface loopback0
description ///Router-ID\\\
ip address {{item.loopbackip}}

interface loopback 1
 description ///TEST NETWORK\\\
ip address {{item.loopbackip1}}

ip route {{item.default}} {{item.gateway}}

router ospf {{item.ospfprocessid}}
 network {{item.network}}
 network {{item.network1}}
 network {{item.network2}}
 network {{item.network3}}
 area 0 authentication message-digest
 passive-interface default
 no passive-interface {{item.gigabitethernet0}}
 no passive-interface {{item.gigabitethernet1}}
 no passive-interface {{item.gigabitethernet2}}
 redistribute eigrp {{item.as}} metric-type 1
 

router eigrp {{item.eigrpname}}
 address-family ipv4 unicast auto {{item.as}}
  network {{item.network4}}
  network {{item.network5}}
  af-interface default
   passive-interface
   exit
  af-interface {{item.gigabitethernet4}}
   no passive-interface
   authentication key-chain {{item.chain}}
   authentication mode md5
  exit
  af-interface {{item.gigabitethernet5}}
   no passive-interface
   authentication key-chain {{item.chain}}
   authentication mode md5
  topology base
   redistribute ospf {{item.ospfprocessid}} metric 1000000 10 255 1 1500

interface {{item.gigabitethernet2}}
 ip add {{item.gi2ip}}
 service-policy output {{item.policy_QOS}}
 no shut

interface {{item.gigabitethernet0}}
 ip add {{item.gi0ip}}
 ip ospf message-digest-key 1 md5 {{item.ospfkey}}
 no shut

interface {{item.gigabitethernet1}}
 no shut

interface {{item.gigabitethernet3}}
 no shut
 
interface {{item.gigabitethernet4}}
 description ///TO_R1_G1/0\\\
 ip address {{item.gi4ip}}
 no shut

interface {{item.gigabitethernet5}}
 description ///TO_R1_G2/0\\\
 ip address {{item.gi5ip}}
 no shut
 
aaa new-model 

tacacs server {{item.tacacs_name}}
 address ipv4 {{item.tacacsip}}
 key {{item.tacacskey}}

aaa group server tacacs+ {{item.tacacsgroup}}
 server name {{item.tacacs_name}}
     
aaa authentication login default group {{item.tacacsgroup}} local

ntp server {{item.ntpmaster}}
clock timezone {{item.timezone}}

key chain {{item.chain}}
 key 1
  send-lifetime {{item.key1time}}
  accept-lifetime {{item.key1time}}
  key-string {{item.key1}}

ip access-list standard {{item.ssh_in}}
  permit {{item.ssh_in_ip}}
  permit {{item.ssh_in_ip1}}

ip access-list extended {{item.web_traffic}}
  permit tcp host {{item.web_traffic_host_1}} any {{item.web_traffic_http}}
  deny tcp {{item.web_traffic_deny_1}} any {{item.web_traffic_http}}
  permit ip any any

ip access-list extended {{item.class_web_traffic_ACL}}
  permit tcp {{item.class_web_traffic_permit_ips}} any {{item.web_traffic_http_https}} 

class-map {{item.video_class}}
  match application {{item.webex}}
  match application {{item.jabber}}
  match application {{item.h323}}
  match {{item.priority_high}}
  match {{item.immediate_high}}
  match {{item.priority_ef}}

class-map {{item.voice_class}}
 match application {{item.voip}}
 match {{item.priority_medium}}
 match {{item.immediate_medium}}

class-map {{item.class_web_traffic}}
 match access-group name {{item.class_web_traffic_ACL}}
 match {{item.priority_low}}
 match {{item.immediate_low}}

policy-map {{item.policy_QOS}}
 class {{item.video_class}}
  bandwidth percent 50
 class {{item.voice_class}}
  bandwidth percent 30
 class {{item.class_web_traffic}}
  bandwidth percent 10
 class class-default
  bandwidth percent 10

line vty 0 4
 access-class {{item.ssh_in}} in 
